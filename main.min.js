var VPro=function(){"use strict";const e={};const t=Symbol("solid-proxy"),n=Symbol("solid-track"),s={equals:(e,t)=>e===t};let r=P;const i={},o={owned:null,cleanups:null,context:null,owner:null};var a=null;let l,c=null,u=null,h=null,d=null,f=0;function p(e,t){const n=c,s=a,r=0===e.length?o:{owned:null,cleanups:null,context:null,owner:t||s};a=r,c=null;try{return C((()=>e((()=>q(r)))),!0)}finally{c=n,a=s}}function g(e,t){t=t?Object.assign({},s,t):s;const n={value:e,observers:null,observerSlots:null,pending:i,comparator:t.equals||void 0};return[N.bind(n),e=>("function"==typeof e&&(e=e(n.pending!==i?n.pending:n.value)),S(n,e))]}function m(e,t,n){X(A(e,t,!0,1))}function y(e,t,n){X(A(e,t,!1,1))}function v(e,t,n){r=L;const s=A(e,t,!1,1);s.user=!0,d?d.push(s):X(s)}function _(e,t,n){n=n?Object.assign({},s,n):s;const r=A(e,t,!0,0);return r.pending=i,r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,X(r),N.bind(r)}function x(t,n,s){2===arguments.length?"object"==typeof n&&(s=n,n=t,t=!0):1===arguments.length&&(n=t,t=!0),s||(s={});const r=new Set,[i,o]=g(s.initialValue),[a,u]=g(void 0,{equals:!1}),[h,d]=g(!1),[f,p]=g();let y,v=null,x=null,k=null,$=!1,N="initialValue"in s,S="function"==typeof t&&_(t);function X(e,t,n,r){return v===e&&(v=null,N=!0,x&&(e===x||t===x)&&s.onHydrated&&queueMicrotask((()=>s.onHydrated(r,{value:t}))),x=null,p(y=n),A(t)),t}function A(e){b((()=>{o((()=>e)),d(!1);for(const e of r.keys())e.decrement();r.clear()}))}function M(){const e=l,t=i();if(y)throw y;return c&&!c.user&&e&&m((()=>{a(),v&&(e.resolved||r.has(e)||(e.increment(),r.add(e)))})),t}function C(e=!0){if(e&&$)return;$=!1,p(y=void 0);const s=S?S():t;if(null==s||!1===s)return void X(v,w(i));const r=x||w((()=>n(s,{value:i(),refetching:e})));return"object"==typeof r&&"then"in r?(v=r,$=!0,queueMicrotask((()=>$=!1)),b((()=>{d(!0),u()})),r.then((e=>X(r,e,void 0,s)),(e=>X(r,e,e)))):(X(v,r),r)}return e.context&&(k=`${e.context.id}${e.context.count++}`,e.load&&(x=e.load(k))),Object.defineProperties(M,{loading:{get:()=>h()},error:{get:()=>f()},latest:{get(){if(!N)return M();if(y)throw y;return i()}}}),S?m((()=>C(!1))):C(!1),[M,{refetch:C,mutate:o}]}function b(e){if(u)return e();let t;const n=u=[];try{t=e()}finally{u=null}return C((()=>{for(let e=0;e<n.length;e+=1){const t=n[e];if(t.pending!==i){const e=t.pending;t.pending=i,S(t,e)}}}),!1),t}function w(e){let t,n=c;return c=null,t=e(),c=n,t}function k(e,t,n){const s=Array.isArray(e);let r,i=n&&n.defer;return n=>{let o;if(s){o=Array(e.length);for(let t=0;t<e.length;t++)o[t]=e[t]()}else o=e();if(i)return void(i=!1);const a=w((()=>t(o,r,n)));return r=o,a}}function $(e){v((()=>w(e)))}function N(){if(this.sources&&this.state){const e=h;h=null,1===this.state?X(this):E(this),h=e}if(c){const e=this.observers?this.observers.length:0;c.sources?(c.sources.push(this),c.sourceSlots.push(e)):(c.sources=[this],c.sourceSlots=[e]),this.observers?(this.observers.push(c),this.observerSlots.push(c.sources.length-1)):(this.observers=[c],this.observerSlots=[c.sources.length-1])}return this.value}function S(e,t,n){if(u)return e.pending===i&&u.push(e),e.pending=t,t;if(e.comparator&&e.comparator(e.value,t))return t;let s=!1;return e.value=t,e.observers&&e.observers.length&&C((()=>{for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];s,n.state||(n.pure?h.push(n):d.push(n),n.observers&&T(n)),n.state=1}if(h.length>1e6)throw h=[],new Error}),!1),t}function X(e){if(!e.fn)return;q(e);const t=a,n=c,s=f;c=a=e,function(e,t,n){let s;try{s=e.fn(t)}catch(e){Y(e)}(!e.updatedAt||e.updatedAt<=n)&&(e.observers&&e.observers.length?S(e,s):e.value=s,e.updatedAt=n)}(e,e.value,s),c=n,a=t}function A(e,t,n,s=1,r){const i={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:a,context:null,pure:n};return null===a||a!==o&&(a.owned?a.owned.push(i):a.owned=[i]),i}function M(e){if(0===e.state)return;if(2===e.state)return E(e);if(e.suspense&&w(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<f);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(1===(e=t[n]).state)X(e);else if(2===e.state){const n=h;h=null,E(e,t[0]),h=n}}function C(e,t){if(h)return e();let n=!1;t||(h=[]),d?n=!0:d=[],f++;try{const t=e();return function(e){h&&(P(h),h=null);if(e)return;d.length?b((()=>{r(d),d=null})):d=null}(n),t}catch(e){Y(e)}finally{h=null,n||(d=null)}}function P(e){for(let t=0;t<e.length;t++)M(e[t])}function L(t){let n,s=0;for(n=0;n<t.length;n++){const e=t[n];e.user?t[s++]=e:M(e)}var r;e.context&&(e.context=r);const i=t.length;for(n=0;n<s;n++)M(t[n]);for(n=i;n<t.length;n++)M(t[n])}function E(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];s.sources&&(1===s.state?s!==t&&M(s):2===s.state&&E(s,t))}}function T(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=2,n.pure?h.push(n):d.push(n),n.observers&&T(n))}}function q(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),n=e.sourceSlots.pop(),s=t.observers;if(s&&s.length){const e=s.pop(),r=t.observerSlots.pop();n<s.length&&(e.sourceSlots[r]=n,s[n]=e,t.observerSlots[n]=r)}}if(e.owned){for(t=0;t<e.owned.length;t++)q(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function Y(e){throw e}const j=Symbol("fallback");function O(e){for(let t=0;t<e.length;t++)e[t]()}function B(e,t,s={}){let r=[],i=[],o=[],l=0,c=t.length>1?[]:null;var u;return u=()=>O(o),null===a||(null===a.cleanups?a.cleanups=[u]:a.cleanups.push(u)),()=>{let a,u,h=e()||[];return h[n],w((()=>{let e,t,n,f,g,m,y,v,_,x=h.length;if(0===x)0!==l&&(O(o),o=[],r=[],i=[],l=0,c&&(c=[])),s.fallback&&(r=[j],i[0]=p((e=>(o[0]=e,s.fallback()))),l=1);else if(0===l){for(i=new Array(x),u=0;u<x;u++)r[u]=h[u],i[u]=p(d);l=x}else{for(n=new Array(x),f=new Array(x),c&&(g=new Array(x)),m=0,y=Math.min(l,x);m<y&&r[m]===h[m];m++);for(y=l-1,v=x-1;y>=m&&v>=m&&r[y]===h[v];y--,v--)n[v]=i[y],f[v]=o[y],c&&(g[v]=c[y]);for(e=new Map,t=new Array(v+1),u=v;u>=m;u--)_=h[u],a=e.get(_),t[u]=void 0===a?-1:a,e.set(_,u);for(a=m;a<=y;a++)_=r[a],u=e.get(_),void 0!==u&&-1!==u?(n[u]=i[a],f[u]=o[a],c&&(g[u]=c[a]),u=t[u],e.set(_,u)):o[a]();for(u=m;u<x;u++)u in n?(i[u]=n[u],o[u]=f[u],c&&(c[u]=g[u],c[u](u))):i[u]=p(d);i=i.slice(0,l=x),r=h.slice(0)}return i}));function d(e){if(o[u]=e,c){const[e,n]=g(u);return c[u]=n,t(h[u],e)}return t(h[u])}}}function z(e,t){return w((()=>e(t||{})))}function F(){return!0}const D={get:(e,n,s)=>n===t?s:e.get(n),has:(e,t)=>e.has(t),set:F,deleteProperty:F,getOwnPropertyDescriptor:(e,t)=>({configurable:!0,enumerable:!0,get:()=>e.get(t),set:F,deleteProperty:F}),ownKeys:e=>e.keys()};function I(e){const t="fallback"in e&&{fallback:()=>e.fallback};return _(B((()=>e.each),e.children,t||void 0))}function G(e){let t=!1;const n=_((()=>e.when),void 0,{equals:(e,n)=>t?e===n:!e==!n});return _((()=>{const s=n();if(s){const n=e.children;return(t="function"==typeof n&&n.length>0)?w((()=>n(s))):n}return e.fallback}))}const V=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline","allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"]),H=new Set(["innerHTML","textContent","innerText","children"]),R={className:"class",htmlFor:"for"},K={class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"},U=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),W=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),Z={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};const J="_$DX_DELEGATE";function Q(e,t,n){const s=document.createElement("template");s.innerHTML=e;let r=s.content.firstChild;return n&&(r=r.firstChild),r}function ee(e,t=window.document){const n=t[J]||(t[J]=new Set);for(let s=0,r=e.length;s<r;s++){const r=e[s];n.has(r)||(n.add(r),t.addEventListener(r,ae))}}function te(e,t){null==t?e.removeAttribute("class"):e.className=t}function ne(e,t,n={}){const s=e.style,r="string"==typeof n;if(null==t&&r||"string"==typeof t)return s.cssText=t;let i,o;for(o in r&&(s.cssText=void 0,n={}),t||(t={}),n)null==t[o]&&s.removeProperty(o),delete n[o];for(o in t)i=t[o],i!==n[o]&&(s.setProperty(o,i),n[o]=i);return n}function se(e,t,n,s){if(void 0===n||s||(s=[]),"function"!=typeof t)return ce(e,t,s,n);y((s=>ce(e,t(),s,n)),s)}function re(t){let n,s;return e.context&&(n=e.registry.get(s=function(){const t=e.context;return`${t.id}${t.count++}`}()))?(e.completed&&e.completed.add(n),e.registry.delete(s),n):t.cloneNode(!0)}function ie(e,t,n){const s=t.trim().split(/\s+/);for(let t=0,r=s.length;t<r;t++)e.classList.toggle(s[t],n)}function oe(e,t,n,s,r,i){let o,a,l;if("style"===t)return ne(e,n,s);if("classList"===t)return function(e,t,n={}){const s=Object.keys(t||{}),r=Object.keys(n);let i,o;for(i=0,o=r.length;i<o;i++){const s=r[i];s&&"undefined"!==s&&!t[s]&&(ie(e,s,!1),delete n[s])}for(i=0,o=s.length;i<o;i++){const r=s[i],o=!!t[r];r&&"undefined"!==r&&n[r]!==o&&o&&(ie(e,r,!0),n[r]=o)}return n}(e,n,s);if(n===s)return s;if("ref"===t)i||n(e);else if("on:"===t.slice(0,3))e.addEventListener(t.slice(3),n);else if("oncapture:"===t.slice(0,10))e.addEventListener(t.slice(10),n,!0);else if("on"===t.slice(0,2)){const s=t.slice(2).toLowerCase(),r=U.has(s);!function(e,t,n,s){s?Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n:Array.isArray(n)?e.addEventListener(t,(e=>n[0](n[1],e))):e.addEventListener(t,n)}(e,s,n,r),r&&ee([s])}else if((l=H.has(t))||!r&&(K[t]||(a=V.has(t)))||(o=e.nodeName.includes("-")))"class"===t||"className"===t?te(e,n):!o||a||l?e[K[t]||t]=n:e[(c=t,c.toLowerCase().replace(/-([a-z])/g,((e,t)=>t.toUpperCase())))]=n;else{const s=r&&t.indexOf(":")>-1&&Z[t.split(":")[0]];s?function(e,t,n,s){null==s?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,s)}(e,s,t,n):function(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}(e,R[t]||t,n)}var c;return n}function ae(t){const n=`$$${t.type}`;let s=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==s&&Object.defineProperty(t,"target",{configurable:!0,value:s}),Object.defineProperty(t,"currentTarget",{configurable:!0,get:()=>s||document}),e.registry&&!e.done&&(e.done=!0,document.querySelectorAll("[id^=pl-]").forEach((e=>e.remove())));null!==s;){const e=s[n];if(e&&!s.disabled){const r=s[`${n}Data`];if(void 0!==r?e(r,t):e(t),t.cancelBubble)return}s=s.host&&s.host!==s&&s.host instanceof Node?s.host:s.parentNode}}function le(e,t,n={},s,r){return t||(t={}),!r&&"children"in t&&y((()=>n.children=ce(e,t.children,n.children))),t.ref&&t.ref(e),y((()=>function(e,t,n,s,r={},i=!1){t||(t={});for(const s in r)if(!(s in t)){if("children"===s)continue;oe(e,s,null,r[s],n,i)}for(const o in t){if("children"===o){s||ce(e,t.children);continue}const a=t[o];r[o]=oe(e,o,a,r[o],n,i)}}(e,t,s,!0,n,!0))),n}function ce(t,n,s,r,i){for(e.context&&!s&&(s=[...t.childNodes]);"function"==typeof s;)s=s();if(n===s)return s;const o=typeof n,a=void 0!==r;if(t=a&&s[0]&&s[0].parentNode||t,"string"===o||"number"===o){if(e.context)return s;if("number"===o&&(n=n.toString()),a){let e=s[0];e&&3===e.nodeType?e.data=n:e=document.createTextNode(n),s=de(t,s,r,e)}else s=""!==s&&"string"==typeof s?t.firstChild.data=n:t.textContent=n}else if(null==n||"boolean"===o){if(e.context)return s;s=de(t,s,r)}else{if("function"===o)return y((()=>{let e=n();for(;"function"==typeof e;)e=e();s=ce(t,e,s,r)})),()=>s;if(Array.isArray(n)){const o=[];if(ue(o,n,i))return y((()=>s=ce(t,o,s,r,!0))),()=>s;if(e.context)for(let e=0;e<o.length;e++)if(o[e].parentNode)return s=o;if(0===o.length){if(s=de(t,s,r),a)return s}else Array.isArray(s)?0===s.length?he(t,o,r):function(e,t,n){let s=n.length,r=t.length,i=s,o=0,a=0,l=t[r-1].nextSibling,c=null;for(;o<r||a<i;)if(t[o]!==n[a]){for(;t[r-1]===n[i-1];)r--,i--;if(r===o){const t=i<s?a?n[a-1].nextSibling:n[i-a]:l;for(;a<i;)e.insertBefore(n[a++],t)}else if(i===a)for(;o<r;)c&&c.has(t[o])||t[o].remove(),o++;else if(t[o]===n[i-1]&&n[a]===t[r-1]){const s=t[--r].nextSibling;e.insertBefore(n[a++],t[o++].nextSibling),e.insertBefore(n[--i],s),t[r]=n[i]}else{if(!c){c=new Map;let e=a;for(;e<i;)c.set(n[e],e++)}const s=c.get(t[o]);if(null!=s)if(a<s&&s<i){let l,u=o,h=1;for(;++u<r&&u<i&&null!=(l=c.get(t[u]))&&l===s+h;)h++;if(h>s-a){const r=t[o];for(;a<s;)e.insertBefore(n[a++],r)}else e.replaceChild(n[a++],t[o++])}else o++;else t[o++].remove()}}else o++,a++}(t,s,o):(s&&de(t),he(t,o));s=o}else if(n instanceof Node){if(e.context&&n.parentNode)return s=a?[n]:n;if(Array.isArray(s)){if(a)return s=de(t,s,r,n);de(t,s,null,n)}else null!=s&&""!==s&&t.firstChild?t.replaceChild(n,t.firstChild):t.appendChild(n);s=n}}return s}function ue(e,t,n){let s=!1;for(let r=0,i=t.length;r<i;r++){let i,o=t[r];if(o instanceof Node)e.push(o);else if(null==o||!0===o||!1===o);else if(Array.isArray(o))s=ue(e,o)||s;else if("string"==(i=typeof o))e.push(document.createTextNode(o));else if("function"===i)if(n){for(;"function"==typeof o;)o=o();s=ue(e,Array.isArray(o)?o:[o])||s}else e.push(o),s=!0;else e.push(document.createTextNode(o.toString()))}return s}function he(e,t,n){for(let s=0,r=t.length;s<r;s++)e.insertBefore(t[s],n)}function de(e,t,n,s){if(void 0===n)return e.textContent="";const r=s||document.createTextNode("");if(t.length){let s=!1;for(let i=t.length-1;i>=0;i--){const o=t[i];if(r!==o){const t=o.parentNode===e;s||i?t&&o.remove():t?e.replaceChild(r,o):e.insertBefore(r,n)}else s=!0}}else e.insertBefore(r,n);return[r]}function fe(t){const[n,s]=function(e,...t){const n=new Set(t.flat()),s=Object.getOwnPropertyDescriptors(e),r=t.map((t=>{const n={};for(let r=0;r<t.length;r++){const i=t[r];Object.defineProperty(n,i,s[i]?s[i]:{get:()=>e[i],set:()=>!0})}return n}));return r.push(new Proxy({get:t=>n.has(t)?void 0:e[t],has:t=>!n.has(t)&&t in e,keys:()=>Object.keys(e).filter((e=>!n.has(e)))},D)),r}(t,["component"]);return _((()=>{const t=n.component;switch(typeof t){case"function":return w((()=>t(s)));case"string":const n=W.has(t),l=e.context?re():function(e,t=!1){return t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e)}(t,n);return r=l,o=n,"function"==typeof(i=s)?y((e=>le(r,i(),e,o,a))):le(r,i,void 0,o,a),l}var r,i,o,a}))}const pe=1e3/60,ge={seconds:60*pe,half:30*pe,thirds:20*pe,lengths:15*pe,sixth:10*pe,five:5*pe,three:50,one:1*pe};class me{static from_angle=e=>new me(Math.cos(e),Math.sin(e));static make=(e,t)=>new me(e,t);static get unit(){return new me(1,1)}static get zero(){return new me(0,0)}get vs(){return[this.x,this.y]}get mul_inverse(){return new me(1/this.x,1/this.y)}get inverse(){return new me(-this.x,-this.y)}get half(){return new me(this.x/2,this.y/2)}get length_squared(){return this.x*this.x+this.y*this.y}get length(){return Math.sqrt(this.length_squared)}get normalize(){return 0===this.length?me.zero:this.scale(1/this.length)}get perpendicular(){return new me(-this.y,this.x)}get clone(){return new me(this.x,this.y)}get angle(){return Math.atan2(this.y,this.x)}constructor(e,t){this.x=e,this.y=t}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}project_to(e){let t=e.length_squared,n=this.dot(e);return me.make(n*e.x/t,n*e.y/t)}distance(e){return this.sub(e).length}addy(e){return me.make(this.x,this.y+e)}add_angle(e){return me.from_angle(this.angle+e)}scale(e){let{clone:t}=this;return t.scale_in(e)}scale_in(e){return this.x*=e,this.y*=e,this}add(e){let{clone:t}=this;return t.add_in(e)}add_in(e){return this.x+=e.x,this.y+=e.y,this}sub(e){let{clone:t}=this;return t.sub_in(e)}sub_in(e){return this.x-=e.x,this.y-=e.y,this}mul(e){let{clone:t}=this;return t.mul_in(e)}mul_in(e){return this.x*=e.x,this.y*=e.y,this}div(e){let{clone:t}=this;return t.div_in(e)}div_in(e){return this.x/=e.x,this.y/=e.y,this}set_in(e,t=this.y){return this.x=e,this.y=t,this}}class ye{static get identity(){return new ye(1,0,0,1,0,0)}static get unit(){return ye.identity}static projection=(e,t)=>new ye(1/e*2,0,0,-1/t*2,-1,1);get clone(){let{a:e,b:t,c:n,d:s,tx:r,ty:i}=this;return new ye(e,t,n,s,r,i)}get inverse(){let{a:e,b:t,c:n,d:s,tx:r,ty:i}=this,o=e*s-t*n;return new ye(s/o,-t/o,-n/o,e/o,(n*i-s*r)/o,-(e*i-t*r)/o)}constructor(e,t,n,s,r,i){this.a=e,this.b=t,this.c=n,this.d=s,this.tx=r,this.ty=i,this.array_t=new Float32Array([e,t,0,n,s,0,r,i,1])}rotate_in(e){let t=Math.cos(e),n=Math.sin(e),s=this.a*t-this.b*n,r=this.a*n+this.b*t,i=this.c*t-this.d*n,o=this.c*n+this.d*t,a=this.tx*t-this.ty*n,l=this.tx*n+this.ty*t;this.a=s,this.b=r,this.c=i,this.d=o,this.tx=a,this.ty=l}rotate(e){let{clone:t}=this;return t.rotate_in(e),t}scale(e,t){let n=this.a*e,s=this.b,r=this.c,i=this.d*t,o=this.tx,a=this.ty;return new ye(n,s,r,i,o,a)}translate_in(e,t){this.a,this.b,this.c,this.d;let n=e+this.tx,s=t+this.ty;this.tx=n,this.ty=s}translate(e,t){let{clone:n}=this;return n.translate_in(e,t),n}scale_in(e,t){this.a=e,this.d=t}mVec2(e){let t=this.a,n=this.b,s=this.c,r=this.d,i=this.tx,o=this.ty,a=t*e.x+s*e.y+i,l=n*e.x+r*e.y+o;return me.make(a,l)}mul_in(e){let{a:t,b:n,c:s,d:r,tx:i,ty:o}=this;this.a=e.a*t+e.b*s,this.b=e.a*n+e.b*r,this.c=e.c*t+e.d*s,this.d=e.c*n+e.d*r,this.tx=e.tx*t+e.ty*s+i,this.ty=e.tx*n+e.ty*r+o}set_in(e){let{a:t,b:n,c:s,d:r,tx:i,ty:o}=e;this.a=t,this.b=n,this.c=s,this.d=r,this.tx=i,this.ty=o}transform_in(e,t,n,s=me.half){this.a=Math.cos(t)*e.x,this.b=Math.sin(t)*e.x,this.c=-Math.sin(t)*e.y,this.d=Math.cos(t)*e.y,this.tx=n.x-(s.x*this.a+s.y*this.c),this.ty=n.y-(s.x*this.b+s.y*this.d)}}function ve(e){let t,n,s=1e3/60,r=s;return t=requestAnimationFrame((function i(o){let a=n?o-n:s;a=Math.min(33.333333333333336,Math.max(16.666666666666668,a)),e(a,r),r=a,n=o,t=requestAnimationFrame(i)})),()=>{cancelAnimationFrame(t)}}function _e(e,t){if("function"==typeof t)return e[1](t);e[1]((e=>t))}function xe(e){return Array.isArray(e)?e[0]():e()}class be{static make=(e,t,n,s=!1)=>new be(e,t,n,s);get move(){return me.make(...this.drag.move).add(this.decay)}get translate(){return me.make(...this.drag.move).sub(this.start)}get drop(){return this.drag.drop}constructor(e,t,n,s){this.drag=e,this.orig=t,this.target=n,this.no_start=s,this.start=me.make(...s?e.move:e.start),this.decay=t.sub(this.start)}}function we(e,t){let n=_(k(function(e){return _((t=>{let[n,s]=e();return t+n}),0)}(e),((e,n)=>e>=t&&Math.floor(n/t)!==Math.floor(e/t))));return _((e=>n()?e:e+1),0)}function ke(e){let t={};return e.replace(".","").replace(/;$/,"").split(";").forEach((e=>{e.split(",").forEach((e=>{let[n,s]=e.trim().split(" = ");t[n]||=[],t[n].push(s)}))})),t}var $e=new class{constructor(){this.session=pl.create()}consult(e){let{session:t}=this;return new Promise(((n,s)=>{t.consult("\n"+e+"\n",{success:n,error:s})}))}_query(e){let{session:t}=this;return new Promise(((n,s)=>{t.query(e,{success:n,error:s})}))}answer(){let{session:e}=this;return new Promise(((t,n)=>e.answer({success:n=>t(e.format_answer(n)),fail:t,error:n})))}one(e){return this._query(e).then((()=>this.answer().then((e=>"true."===e||(e?ke(e):void 0)))))}async all(e){await this._query(e);let t="";for(let e=0;e<64;e++){let e=await this.answer();if("boolean"==typeof e){if(""===t)return e;break}if(!e)break;t+=e}return ke(t)}},Ne="% Prolog \n:- use_module(library(lists)).\n\n\n:- dynamic(time/1).\n\ntime(0).\n\ntick :- time(N), N1 is N + 1, retract(time(N)), assertz(time(N1)).\n\n\n:- dynamic(interaction/1).\n\n:- dynamic(file/1).\n\n\n\nadd_interaction(X) :- \\+ interaction(X), assertz(interaction(X)).\n",Se="% Prolog \nsessions(1).\nsessions(2).\nsessions(3).\nsessions(4).\n\n\nsession_progress(1, 1) :- interaction(drag_box).\nsession_progress(1, 2) :- interaction(dup_box).\nsession_progress(1, 3) :- interaction(dispose_box).\n\n\nsession_progress(2, 1) :- interaction(word_inside_paranthesis).\n\nsession(1, 0).\nsession(X, 0) :- sessions(X), Y is X - 1, findall(_, session_progress(Y, _), Ls), length(Ls, 3).\nsession(X, Y) :- session_progress(X, Y).\n\n\ncounter(_) :- fail.\n\nfile(a).\nfile(b).\nfile(c).\n";function Xe(e,t){return`${e} ${t}`}function Ae(e){let[t,{refetch:n}]=e;n()}const Me={change(e,t,n){this.retract(e,n),this.assert(e,t)},assert:(e,t)=>Ce((n=>$e.one(`assertz(${e}(${t})).`)))(),retract:(e,t)=>Ce((n=>$e.one(`retract(${e}(${t})).`)))()};let Ce=function(){let e=Promise.resolve();return t=>n=>new Promise(((s,r)=>{e=e.then((()=>t(n).then(s).catch(r)))}))}();class Pe{get atoms(){return this.m_atoms().slice(0).sort(((e,t)=>e.dragging?t.dragging?0:1:t.dragging?-1:0))}get selected_atoms(){return this.atoms.filter((e=>e.selected))}get flash(){return this.m_flash()}get files(){return this.m_files()}get help(){return this.m_helps()[this.m_session()]}async dup_atom(e){let t=e.ghost_rectangle;this._atom_pos_hint=Le(t[0],t[1]),this._inject_drag=!0,Me.assert(e.name,e.value),Ae(this.r_files),this.interaction("dup_box")}async dispose_atom(e){Me.retract(e.name,e.value),Ae(this.r_files)}async interaction_drag_box(){this.interaction("drag_box")}async interaction(e){await Ce((t=>$e.one(`add_interaction(${e}).`)))(),this.help.refetch(),Ae(this.r_session)}constructor(){let e=g([16,16],{equals:!1});ve(((t,n)=>{_e(e,[t,n])}));let t=()=>xe(e);this.m_update=t,x([Ne,Se].join("\n"),Ce((e=>$e.consult(e))));let n=x("counter(X).",Ce((e=>$e.one(e)))),s=x("time(X).",Ce((e=>$e.one(e))));v(k(n[0],(()=>{v(k(we(t,ge.seconds),(async(e,t)=>{t&&(await Ce((e=>$e.one("tick."))),Ae(s),Ae(n))})))})));let r=x("file(X).",Ce((e=>$e.all(e)))),i=_((()=>{let e=xe(r);return e?e.X.map((e=>Xe("file",e))):[]}));this.r_files=r,this.m_files=_((()=>i().map((e=>e.split(" ")[1])))),_((()=>{let e=xe(s);if(!0===e);else if(e)return e.X.map((e=>Xe("time",e)));return[]})),_((()=>{let e=xe(n);if(!0===e);else if(e)return e.X.map((e=>Xe("counter",e)));return[]})),this.m_flash=_((()=>{let e=xe(n);if(!0===e);else if(e)return e.X[0]}));let o=_((()=>[...i()]));this.m_atoms=_(B(o,(e=>function(e,t){let[n,s]=t.split(" "),r=g(n),i=g(s),o=g(!1),a=g(!1),l=g(),c=e._atom_pos_hint?.clone||Le(10,10),u=g(e._inject_drag&&e._atom_pos_hint?.clone);e._inject_drag=!1,e._atom_pos_hint=!1;let h=g(),d=g(),f=_((()=>[c.x,c.y,30,30])),p=_((()=>[c.x,c.y,10,10])),m=_((()=>xe(h)?.getBoundingClientRect())),y=_((()=>{let e=m();return e?[c.x,c.y,e.width,e.height]:[c.x,c.y,0,0]})),x=_((()=>{let e=xe(d);if(e){let t=e.getBoundingClientRect();return[t.left,t.top,t.width,t.height]}return[0,0,0,0]})),b=g(!1),w=_((()=>xe(o))),$=_((()=>xe(a))),N=function(e,t){const n=g(e());let s;return v((()=>{e();let r=t();clearTimeout(s),void 0!==r?s=setTimeout((()=>{_e(n,e())}),r):_e(n,void 0)})),()=>xe(n)}($,(()=>w()||$()?0:ge.half+ge.lengths)),S=_((()=>!w()&&N()));return v(k(i[0],(async(t,s)=>{s&&(e.interaction("word_inside_paranthesis"),e._atom_pos_hint=c.clone,Me.change(n,t,s),Ae(e.r_files))}))),{get allow_edit(){return!1},set $ghost(e){_e(d,e)},set $_(e){_e(h,e)},get key(){return atom_key},get name(){return xe(r)},get value(){return xe(i)},get x(){return c.x},get y(){return c.y},on_close:(e,t)=>Ee(...p(),e,t),on_full:(e,t)=>Ee(...y(),e,t),on:(e,t)=>Ee(...f(),e,t),on_ghost(e,t){if(S())return Ee(...x(),e,t)},on_inject_drag(){let e=xe(u);return e&&_e(u,!1),e},get ghost_rectangle(){return x()},in_rect:(e,t)=>function(e,t){let n=e[0],s=e[0]+e[2],r=e[1],i=e[1]+e[3],o=t[0],a=t[0]+t[2],l=t[1],c=t[1]+t[3];return!(o>s||a<n||l>i||c<r)}(f(),[e.x,e.y,t.x,t.y]),set selected(e){_e(b,e)},get selected(){return xe(b)},pos:c,get dragging(){return xe(o)},set dragging(e){return _e(o,e)},get hovering(){return xe(a)},set hovering(e){return _e(a,e)},get editing(){return xe(l)},set editing(e){return _e(l,e)},get show_ghost(){return S()},editing_value(e,t){13===e&&(_e(i,t),this.editing=!1)},editing_name(e,t){13===e&&(_e(r,t),this.editing=!1)},async dispose(){e.interaction("dispose_box"),e.dispose_atom(this)}}}(this,e))));let a=_((()=>[0,1,2,3,4,5,6]));this.m_helps=_(B(a,(e=>function(e,t){let n=x(`session(${t}, X).`,Ce((e=>$e.all(e)))),s=_((()=>{let e=xe(n);return e?e.X:[]}));return{session:t,refetch(){Ae(n)},completed:e=>s().includes(e+""),nav_prev(){},nav_next(){e.session}}}(this,e))));let l=x("session(X, _).",Ce((e=>$e.all(e))));this.r_session=l,this.m_session=_((()=>{let e=xe(l);return e?Math.max(...e.X.map((e=>parseInt(e)))):1}))}}function Le(e,t){let n=g(e,{equals:!1}),s=g(t,{equals:!1}),r=_((()=>Ye(xe(n),xe(s)))),i=_((()=>me.make(xe(n),xe(s))));return{get point(){return r()},get x(){return xe(n)},set x(e){_e(n,e)},get y(){return xe(s)},set y(e){_e(s,e)},set vs(e){b((()=>{_e(n,(t=>Te(t,e.x))),_e(s,(t=>Te(t,e.y)))}))},get vs(){return i()},get clone(){return Le(xe(n),xe(s))}}}function Ee(e,t,n,s,r,i){return e<=r&&r<=e+n&&t<=i&&i<=t+s}function Te(e,t){return e+.5*(t-e)}const qe=(()=>{let e=0;return()=>++e})();function Ye(e,t){return`${e} ${t} ${qe()}`}Ye(0,0);class je{_wheel=0;_wheel0=0;get bounds(){return this._bounds||(this._bounds=this.$canvas.getBoundingClientRect()),this._bounds}get wheel(){return this._wheel}get drag(){if(this._drag?.move)return this._drag}get click(){if(!this._drag?.move&&this._drag?.drop)return this._drag.drop}get lclick(){if(0===this._drag?.button)return this.click}get rclick(){if(2===this._drag?.button)return this.click}get click_down(){if(!this._drag0&&this._drag&&!this._drag?.move&&!this._drag?.drop)return this._drag.start}get hover(){if(!this._drag)return this._hover}get drag_delta(){if(this._drag?.move)return[this._drag.move[0]-this._drag.start[0],this._drag.move[1]-this._drag.start[1]]}constructor(e){this.$canvas=e}eventPosition(e){let t=function(e){return void 0!==e.clientX&&void 0!==e.clientY?[e.clientX,e.clientY]:e.targetTouches?.[0]?[e.targetTouches[0].clientX,e.targetTouches[0].clientY]:void 0}(e),{bounds:n}=this;return t&&(t[0]-=n.left,t[1]-=n.top,t[0]*=1,t[1]*=1),t}disposes=[];dispose(){this.disposes.forEach((e=>e()))}init(){let{$canvas:e,disposes:t}=this;e.addEventListener("wheel",(e=>{this._wheel=Math.sign(e.deltaY)})),e.addEventListener("mousedown",(e=>{this._drag||(this._drag1={button:e.button,start:this.eventPosition(e)})})),e.addEventListener("mousemove",(e=>{this._drag?this._drag.r_move=this.eventPosition(e):this._hover=this.eventPosition(e)})),e.addEventListener("contextmenu",(e=>{e.preventDefault(),this._drag||(this._drag1={button:e.button,start:this.eventPosition(e)})}));let n=e=>{this._drag&&(this._drag.drop=this.eventPosition(e),this._drop0=this._drag)};document.addEventListener("mouseup",n),t.push((()=>document.removeEventListener("mouseup",n)));const s=()=>{this._bounds=void 0};return window.addEventListener("resize",s),document.addEventListener("scroll",s),t.push((()=>window.removeEventListener("resize",s))),t.push((()=>document.removeEventListener("scroll",s))),this}update(e,t){this._wheel0===this._wheel?this._wheel=0:this._wheel0=this._wheel,this._drag&&(this._drag.move0=this._drag.move,void 0!==this._drag.r_move&&(this._drag.move||function(e,t){let n=e[0]-t[0],s=e[1]-t[1];return Math.sqrt(n*n+s*s)>3}(this._drag.r_move,this._drag.start))&&(this._drag.move=this._drag.r_move),this._drop0?this._drop0=void 0:this._drag.drop&&(this._drag1=void 0)),this._drag0=this._drag,this._drag1!==this._drag&&(this._drag=this._drag1)}}function Oe(e,t,n,s,r){return{max_force:r,max_speed:s,air_friction:n,mass:t,force:0,x:e,x0:e,vx:0}}function Be(e,t){let n=t*t/(e*e);return n=n>1?1:Math.sqrt(n),e*n}function ze(e,t,n){let{air_friction:s,force:r,mass:i,max_speed:o,max_force:a}=e,{x:l,x0:c}=e,u=r/i;u=Be(u,a);let h=(l-c)*s*t/n+u*t*(t+n)/2;h=Be(h,o);let d=l,f=l+h;e.x0=d,e.x=f,e.vx=h}function Fe(e){return me.make(e.tx,e.ty)}function De(e,t){let n=me.unit,s=Oe(e.x,t.mass,t.air_friction,t.max_speed,t.max_force),r=Oe(e.y,t.mass,t.air_friction,t.max_speed,t.max_force);return{update:function(e,t){let i=me.make(s.x,r.x),o=me.make(s.vx,r.vx),a=o.normalize;a=0===a.length?me.unit:a;let l=function(e,t,n){let s=e.x,r=t.x,i=e.y,o=t.y,a=n.x,l=n.y;return new ye(s,r,i,o,a,l)}(a,a.perpendicular,i),c=function(e,t,n,s,r){t.x+=(1-2*Math.random())*n,t.y+=(1-2*Math.random())*n;let i=(t=t.normalize).scale(s).add(me.make(r,0));return e.mVec2(i).sub(Fe(e))}(l,n,10,500,20),u=c.sub(o);u=u.scale(s.max_force/s.max_speed),s.force+=u.x,r.force+=u.y,Math.random()<.1&&n.set_in(0,0);{let e=500;if(c=function(e,t,n){let s=Fe(e),r=function(e){return me.make(e.a,e.c)}(e);!function(e){me.make(e.b,e.d)}(e);let i,o,a,l,c=[];return c.push(r.scale(t).add_in(s)),c.push(r.add_angle(.25*-Math.PI).scale_in(t/2).add_in(s)),c.push(r.add_angle(.25*Math.PI).scale_in(t/2).add_in(s)),c.forEach((e=>{if(n.forEach((t=>{let n=t.intersects(Ie.make(s,e));if(n){let[e,s]=n;(!o||e<o)&&(o=e,a=t,l=s)}})),a){let t=e.sub(l);i=a.normal.scale(t.length)}})),i}(l,100,[Ie.from_xy(e,0,e,e),Ie.from_xy(0,e,0,0),Ie.from_xy(0,0,e,0),Ie.from_xy(e,e,0,e)]),c){n.set_in(0,0);let e=c.sub(o);e=e.scale(s.max_force/s.max_speed),s.force=e.x,r.force=e.y}}ze(s,e,t),ze(r,e,t)},get x(){return s.x},get y(){return r.x}}}class Ie{static make=(e,t)=>new Ie(e,t);static from_xy=(e,t,n,s)=>Ie.make(me.make(e,t),me.make(n,s));constructor(e,t){this.a=e,this.b=t,this.parallel=t.sub(e).normalize,this.normal=this.parallel.perpendicular}intersects(e){let{a:t,b:n}=this,{a:s,b:r}=e,i=(t.y-s.y)*(r.x-s.x)-(t.x-s.x)*(r.y-s.y),o=(n.x-t.x)*(r.y-s.y)-(n.y-t.y)*(r.x-s.x),a=(t.y-s.y)*(n.x-t.x)-(t.x-s.x)*(n.y-t.y),l=(n.x-t.x)*(r.y-s.y)-(n.y-t.y)*(r.x-s.x);if(0===o||0===l)return;let c=i/o,u=a/l;if(c>0&&c<1&&u>0&&u<1){return[t.distance(n)*c,t.add(n.sub(t).scale_in(c))]}}}const Ge=Q('<div class="overlay help"><div class="title"><h2> <!> </h2></div><div class="content"></div><div class="nav"><span class="button"> Prev </span><span class="button"> Next </span></div></div>'),Ve=Q('<div class="long"><p>How can we state the fact that "right2 of a is c", "b is d", "c is e", "d is f", "e is g", "f is h". That is two rights of a file. We can enumerate all of the facts and write them manually, or spot the pattern: "Two rights of X is, as we imagine there is a file Z where right of X is Z and right of Z is Y".</p><p>Try to state this fact, using the comma operator as "logical and".</p><p>For extra practice, state <span class="atom">left2(X-Y)</span>, <span class="atom">up2(X-Y)</span> and <span class="atom">down2(X-Y)</span> facts. Get comfortable for the next challenge where we answer the fact that "righter to a to h is the list [b,c,d,e,f,g]".</p></div>'),He=Q('<div class="long"><p>Let\'s tell machine "left of b is a" using the fact that "right of a is b". Because for all the facts that "right of X is Y" it is also a fact that "left of Y is X".</p><p><span class="atom"> left(X-Y) :- right(Y-X). </span></p><p>Notice you can still state <span class="atom"> left(b-a). </span> manually for all files and machine will correspond the same.</p><p><small>If you use a variable that is not a file, like <span class="atom">left(apple, x).</span>, it is still a fact, but machine won\'t correspond, because it also checks for a fact that X and Y are files, and "left of X is Y" to correspond. Just an implicit extra rule. Like this: <span class="atom"> show_arrow(X, Y) :- left(X, Y), file(X), file(Y).</span> . To define the fact to show an arrow, three other facts are stated by a logical "and" clause, (by a comma), meaning that "show an arrow from X to Y when left of X is Y and X is a file and Y is a file".</small></p><p><small>If you want to practice, same concepts apply to 8 ranks, being they have up and down. So define the facts <span class="atom">rank(1)</span> thru 8. and <span class="atom">up(1-2)</span> and <span class="atom">down(X-Y)</span> in terms of up.</small></p></div>'),Re=Q('<div class="short"><p>This gives order to files, because machine can answer "right of a is b".</p><p>State all the facts for each file that has a right file neighbor. Notice "h" doesn\'t have a right file neighbor, so we don\'t state anything for right of "h".</p></div>'),Ke=Q('<div class="long"><p>A <span class="atom">file(X)</span> structure just floats around.</p><p>Notice the <span class="atom">right(X-Y)</span> structure. A dash pairs two words, and fits in place of one word inside paranthesis.</p><p>Machine can answer the blank, if we put an uppercase word in place of left or right side of a pair.</p><p>Write some structures with paired words. Then ask a question by writing an uppercase word in place of one of the pairs.</p><p>For example, if there is a <span class="atom"> right(a-b) </span> , and we ask for <span class="atom"> right(X-b) </span>, it answers <span class="atom"> X = b </span> .</p></div>'),Ue=Q("<p>A chess board has 8 files and 8 ranks that are placed horizontally and vertically.</p>"),We=Q('<p>State all files a, b, c, d, e, f, g, h. So machine can answer "a is a file", or enumerate all files.</p>'),Ze=Q('<p>If you want, you can skip to the solution by clicking "Solution" below.</p>'),Je=Q('<span class="atom"> file(X).</span>'),Qe=Q('<span class="atom">white boxes</span>'),et=Q("<p></p>"),tt=["Introduction","Rename the structure"],nt=e=>(()=>{const t=Ge.cloneNode(!0),n=t.firstChild,s=n.firstChild,r=s.firstChild.nextSibling;r.nextSibling;const i=n.nextSibling,o=i.nextSibling.firstChild,a=o.nextSibling;return se(s,(()=>tt[e.help.session-1]),r),se(i,z(fe,{get session(){return e.help},get component(){return rt[e.help.session-1]}})),o.$$click=t=>e.help.nav_prev(),a.$$click=t=>e.help.nav_next(),t})(),st=e=>(()=>{const t=et.cloneNode(!0);return se(t,(()=>e.children)),y((()=>te(t,[e.completed?"completed":""]))),t})(),rt=[e=>[z(st,{get completed(){return e.session.completed(1)},get children(){return["Play with ",Qe.cloneNode(!0),". Hover on one's top left, as the orange dot appears. So you can drag them around."]}}),z(st,{get completed(){return e.session.completed(2)},children:"Notice on hover, there is a ghost box appear. Drag that ghost to duplicate one."}),z(st,{get completed(){return e.session.completed(3)},children:"Click on the orange dot that appears on top left as you hover, to delete a box."}),z(st,{children:'Click on "Next" at the bottom to advance.'})],e=>[z(st,{children:"These white boxes have a structure. "}),z(st,{get completed(){return e.session.completed(1)},children:"Change the word inside paranthesis by clicking on it."}),z(st,{children:"Just put only lowercase english letters."}),z(st,{get children(){return["Notice the wandering letters corresponds to ",Je.cloneNode(!0),' structure. Where "X" is replaced by the lowercase word put in.']}})],()=>[Ue.cloneNode(!0),We.cloneNode(!0),Ze.cloneNode(!0)],()=>Ke.cloneNode(!0),()=>Re.cloneNode(!0),()=>He.cloneNode(!0),e=>Ve.cloneNode(!0)];ee(["click"]);const it=Q("<vpro></vpro>"),ot=Q('<div class="overlay files"></div>'),at=Q('<span class="file"></span>'),lt=Q('<div class="flash"> <!> </div>'),ct=Q("<grid></grid>"),ut=Q('<div class="selection"></div>'),ht=Q('<span class="ghost"></span>'),dt=Q('<atom><div class="wrap">(<!>)</div><span class="target"></span></atom>'),ft=Q('<span class="name"></span>'),pt=Q('<span class="value"></span>'),gt=Q('<input type="text">'),mt=()=>{let e=new Pe;return(()=>{const t=it.cloneNode(!0);return se(t,z(xt,{game:e,get atoms(){return e.atoms}}),null),se(t,z(yt,{game:e}),null),se(t,z(_t,{game:e,get flash(){return e.flash}}),null),se(t,z(nt,{game:e,get help(){return e.help}}),null),t})()},yt=e=>(()=>{const t=ot.cloneNode(!0);return se(t,z(I,{get each(){return e.game.files},children:t=>z(vt,{get update(){return e.game.m_update},children:(e,n)=>(()=>{const s=at.cloneNode(!0);return se(s,t),y((t=>ne(s,((e,t)=>({transform:`translate(${e}px, ${t}px)`}))(e,n),t))),s})()})})),t})(),vt=e=>{let t=De(me.make(50,50),{mass:1e3,air_friction:.8,max_speed:1,max_force:.1}),n=_(k(e.update,(([e,n])=>(t.update(e,n),me.make(t.x,t.y)))));return _((()=>e.children(n().x,n().y)))},_t=e=>z(G,{get when(){return e.flash},children:e=>(()=>{const t=lt.cloneNode(!0),n=t.firstChild.nextSibling;return n.nextSibling,se(t,e,n),t})()}),xt=e=>{let t,n=g(),s=g(),r=_((()=>xe(s))),i=_((()=>xe(n))),o=g([16,16],{equals:!1}),a=_((()=>xe(o))),l=g();v(k(_((()=>xe(l))),((e,t)=>{e&&!t&&(e.hovering=!0),!e&&t&&(t.hovering=!1),e&&t&&(t.hovering=!1)}))),v(k(r,((e,t)=>{e&&!t&&(e.target.dragging=!0),!e&&t&&(t.target.dragging=!1)}))),$((()=>{let r=new je(t).init();ve(((t,i)=>{r.update(t,i),_e(o,[t,i]);let{click:a,hover:c,drag:u}=r;if(a&&e.atoms.forEach((e=>{e.on_close(...a)&&e.dispose(),e.on_full(...a)||(e.editing=!1)})),c){let t=e.atoms.find((e=>e.on(...c)));_e(l,t||void 0)}else _e(l,void 0);if(u&&u.move0){let t=e.atoms.find((e=>e.on_inject_drag()));t&&_e(s,new be(u,t.pos.vs,t,!0))}if(u&&!u.move0){let t=e.atoms.find((e=>e.on_ghost(...u.start)));if(t)return void e.game.dup_atom(t);let r=e.atoms.find((e=>e.on(...u.start)));r?_e(s,new be(u,r.pos.vs,r)):_e(n,new be(u,me.make(...u.start),Le(0,0)))}}))})),v((()=>{let t=r();t&&v(k(a,((n,r)=>{t.target.pos.vs=t.move,t.drop&&(e.game.interaction_drag_box(),_e(s,void 0))})))})),v((()=>{let t=i();t&&v(k(a,((s,r)=>{t.target.vs=t.translate.clone,t.drop&&(e.atoms.forEach((e=>e.selected=!1)),e.atoms.filter((e=>e.in_rect(t.start,t.target.vs))).forEach((e=>e.selected=!0)),_e(n,void 0))})))}));return(()=>{const n=ct.cloneNode(!0);return"function"==typeof t?t(n):t=n,se(n,z(I,{get each(){return e.atoms},children:e=>z(bt,{atom:e})}),null),se(n,z(G,{get when(){return i()},children:e=>(()=>{const t=ut.cloneNode(!0);return y((n=>{return ne(t,(s=e.start,r=e.target.x,i=e.target.y,{transform:`translate(${s.x}px, ${s.y}px)`,width:`${r}px`,height:`${i}px`}),n);var s,r,i})),t})()}),null),y((e=>ne(n,{"font-size":"2em"},e))),n})()},bt=e=>(()=>{const t=dt.cloneNode(!0),n=t.firstChild,s=n.firstChild,r=s.nextSibling;var i;return r.nextSibling,n.nextSibling,i=t,setTimeout((()=>e.atom.$_=i)),se(n,z(G,{get when(){return"name"===e.atom.editing},get fallback(){return(()=>{const t=ft.cloneNode(!0);return t.$$click=t=>e.atom.editing=e.atom.allow_edit,se(t,(()=>e.atom.name)),t})()},get children(){return z(wt,{onKeyUp:(t,n)=>e.atom.editing_name(t.keyCode,n)})}}),s),se(n,z(G,{get when(){return"value"===e.atom.editing},get fallback(){return(()=>{const t=pt.cloneNode(!0);return t.$$click=t=>e.atom.editing="value",se(t,(()=>e.atom.value)),t})()},get children(){return z(wt,{onKeyUp:(t,n)=>e.atom.editing_value(t.keyCode,n)})}}),r),se(t,z(G,{get when(){return e.atom.show_ghost},get children(){const t=ht.cloneNode(!0);return(t=>{setTimeout((()=>e.atom.$ghost=t))})(t),se(t,(()=>e.atom.name)),t}}),null),y((n=>{const s=["handle",e.atom.dragging?"dragging":"",e.atom.selected?"selected":""].join(" "),r={transform:`translate(${e.atom.x}px, ${e.atom.y}px)`};return s!==n._v$&&te(t,n._v$=s),n._v$2=ne(t,r,n._v$2),n}),{_v$:void 0,_v$2:void 0}),t})(),wt=e=>{let t;return $((()=>{t.focus()})),(()=>{const n=gt.cloneNode(!0);n.$$keyup=n=>e.onKeyUp(n,t.value);return"function"==typeof t?t(n):t=n,n})()};return ee(["click","keyup"]),function(e){!function(e,t,n){let s;p((r=>{s=r,t===document?e():se(t,e(),t.firstChild?null:void 0,n)}))}(mt,e)}}();
